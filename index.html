<!DOCTYPE html>


<!DOCTYPE html>
<html>
<head>
  <title>Bronco Generation Image Recognition</title>
  <style>
        body {
    border: 6px solid black;
    background-color: lightblue;
    padding: 20px;
  }
    .drop-area {
      border: 2px dashed #000000;
      padding: 20px;
      text-align: center;
      margin-bottom: 20px;
    }
    
    .drop-area.highlight {
      background-color: #f7f7f7;
    }
    
    img.preview {
      max-width: 200px;
      max-height: 200px;
      margin-top: 20px;

    }
    
        #clearButton {
      font-size: 16px;
      padding: 10px 20px;
      background-color: darkblue;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
  </style>
</head>
<body>
  <h1>Bronco Generation Image Recognition</h1>
  <div class="drop-area" id="dropArea">
    <h2>Drag and Drop an Image Here</h2>
    <input id="photo" type="file" style="display: none;">
  </div>
  <div id="results"></div>
  <button id="clearButton" onclick="clearImage()">Clear Image</button>
</body>
<script>
  var dropArea = document.getElementById('dropArea');
  var photo = document.getElementById('photo');
  var results = document.getElementById('results');

  // Prevent default drag behaviors
  ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
    dropArea.addEventListener(eventName, preventDefaults, false);
    document.body.addEventListener(eventName, preventDefaults, false);
  });

  // Highlight drop area when item is dragged over it
  ['dragenter', 'dragover'].forEach(eventName => {
    dropArea.addEventListener(eventName, highlight, false);
  });

  // Remove highlight when item is dragged out of drop area
  ['dragleave', 'drop'].forEach(eventName => {
    dropArea.addEventListener(eventName, unhighlight, false);
  });

  // Handle dropped files
  dropArea.addEventListener('drop', handleDrop, false);

  // Handle file input change
  photo.addEventListener('change', read, false);

  function preventDefaults(e) {
    e.preventDefault();
    e.stopPropagation();
  }

  function highlight() {
    dropArea.classList.add('highlight');
  }

  function unhighlight() {
    dropArea.classList.remove('highlight');
  }

  function handleDrop(e) {
    var dt = e.dataTransfer;
    var files = dt.files;

    photo.files = files;
    read();
  }

  function read() {
    const reader = new FileReader();
    reader.addEventListener('load', loaded);
    reader.readAsDataURL(photo.files[0]);
  }

  async function loaded() {
    const reader = this;
    const response = await fetch('https://blakewiley-broncoid.hf.space/api/predict/', {
      method: 'POST',
      body: JSON.stringify({ "data": [reader.result] }),
      headers: { "Content-Type": "application/json" }
    });

    const json = await response.json();
    const label = json['data'][0]['confidences'][0]['label'];
    const confidence = json['data'][0]['confidences'][0]['confidence'];
    results.innerHTML = `<br/><img src="${reader.result}" width="300"> <p>This is likely a ${label} with a confidence of ${parseFloat(confidence * 100).toFixed(2)}%</p>`;
  }

  function clearImage() {
    results.innerHTML = '';
    photo.value = '';
  }
</script>
</html>

</html>
